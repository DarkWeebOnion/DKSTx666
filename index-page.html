<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>الصفحة الرئيسية</title>
<style>
body {
    margin: 0;
    font-family: Arial, sans-serif;
    background: #111;
    color: white;
}
header {
    display: flex;
    justify-content: space-around;
    background: #222;
    padding: 10px;
}
header button {
    background: #444;
    border: none;
    padding: 10px;
    color: white;
    cursor: pointer;
    border-radius: 5px;
}
header button.active {
    background: #660000;
}
#groupControls, #groupFeatures {
    padding: 15px;
    display: none;
}
input, select {
    padding: 5px;
    margin: 5px 0;
    width: 100%;
}
button {
    padding: 10px;
    margin-top: 5px;
}
.transparent {
    opacity: 0.5;
    pointer-events: none;
}
.member-item {
    display: flex;
    justify-content: space-between;
    padding: 5px;
    background: #333;
    margin: 5px 0;
    border-radius: 5px;
}
</style>
</head>
<body>

<header>
    <button id="postsBtn">واجهة المنشورات</button>
    <button id="privateChatBtn">الدردشة الخاصة</button>
    <button id="groupChatBtn">إنشاء دردشة جماعية</button>
</header>

<div id="groupControls">
    <button id="createGroupBtn">إنشاء مجموعة دردشة</button>
</div>

<div id="groupFeatures">
    <h3>إدارة المجموعة</h3>
    <label>اسم المجموعة:</label>
    <input type="text" id="groupName">
    <label>صورة المجموعة:</label>
    <input type="file" id="groupImage">
    <button id="saveGroup">حفظ الإعدادات</button>
    <hr>
    <button id="addMembersBtn">إضافة أعضاء</button>
    <div id="membersList"></div>
    <hr>
    <label><input type="checkbox" id="toggleNick"> السماح بتغيير الكنية</label><br>
    <label><input type="checkbox" id="toggleImage"> السماح بتغيير صورة المجموعة</label><br>
    <label><input type="checkbox" id="toggleName"> السماح بتغيير اسم المجموعة</label><br>
    <label><input type="checkbox" id="toggleAddMembers"> السماح بإضافة الأعضاء</label>
</div>

<script>
let isVIP = localStorage.getItem("vip") === "true";
let groups = JSON.parse(localStorage.getItem("groups") || "[]");

document.getElementById("groupChatBtn").onclick = function() {
    document.getElementById("groupChatBtn").classList.toggle("active");
    document.getElementById("groupControls").style.display = 
        document.getElementById("groupControls").style.display === "block" ? "none" : "block";
};

document.getElementById("createGroupBtn").onclick = function() {
    document.getElementById("groupFeatures").style.display = "block";
    let newGroup = {
        name: "",
        image: "",
        members: [],
        allowNick: true,
        allowImage: true,
        allowName: true,
        allowAdd: true
    };
    groups.push(newGroup);
    localStorage.setItem("groups", JSON.stringify(groups));
};

document.getElementById("saveGroup").onclick = function() {
    let lastGroup = groups[groups.length - 1];
    lastGroup.name = document.getElementById("groupName").value;
    lastGroup.allowNick = document.getElementById("toggleNick").checked;
    lastGroup.allowImage = document.getElementById("toggleImage").checked;
    lastGroup.allowName = document.getElementById("toggleName").checked;
    lastGroup.allowAdd = document.getElementById("toggleAddMembers").checked;
    localStorage.setItem("groups", JSON.stringify(groups));
};

document.getElementById("addMembersBtn").onclick = function() {
    let username = prompt("أدخل اسم المستخدم لإضافته:");
    if(username) {
        let lastGroup = groups[groups.length - 1];
        if(lastGroup.allowAdd || isVIP) {
            lastGroup.members.push({name: username, nick: username});
            localStorage.setItem("groups", JSON.stringify(groups));
            renderMembers(lastGroup.members);
        } else {
            alert("إضافة الأعضاء غير مسموح بها");
        }
    }
};

function renderMembers(members) {
    let list = document.getElementById("membersList");
    list.innerHTML = "";
    members.forEach((m, index) => {
        let div = document.createElement("div");
        div.className = "member-item";
        div.innerHTML = `<span>${m.nick}</span> 
        <button ${!isVIP ? 'class="transparent"' : ''} onclick="removeMember(${index})">إزالة</button>`;
        list.appendChild(div);
    });
}

window.removeMember = function(index) {
    let lastGroup = groups[groups.length - 1];
    lastGroup.members.splice(index, 1);
    localStorage.setItem("groups", JSON.stringify(groups));
    renderMembers(lastGroup.members);
};
</script>

</body>
</html>

